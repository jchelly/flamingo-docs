Particle properties
===================

This page documents all of the properties which are stored for each
type of particle in a FLAMINGO snapshot.

In the Units column in the tables below we use :math:`a` to indicate
the expansion factor at the time of the snapshot, so that comoving
megaparsecs are expressed in units of :math:`a\mathrm{Mpc}`. In the
Shape column, N indicates the number of particles in the dataset.

.. note:: Units are provided here for information, but it's usually
          better to use the metadata in the files for any unit
          conversions. The `swiftsimio
          <https://swiftsimio.readthedocs.io/en/latest/loading_data/index.html>`__
          python module handles units automatically in snapshots and
          SOAP halo catalogues.

Gas particles
-------------

Gas particles are stored in the HDF5 group ``/PartType0``, which is
also soft-linked as ``/GasParticles``. This group contains HDF5
datasets which store the following particle properties:

+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                               | Type    | Shape      | Units                                                                      | Description                                                                                                                                                                                                              |
+====================================+=========+============+============================================================================+==========================================================================================================================================================================================================================+
| ``ComptonYParameters``             | float32 | N          | :math:`\mathrm{Mpc}^2`                                                     | Compton y parameters in the physical frame computed based on the cooling tables. This is 0 for star-forming particles.                                                                                                   |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``Coordinates``                    | float64 | N,3        | :math:`a\mathrm{Mpc}`                                                      | Co-moving positions of the particles                                                                                                                                                                                     |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``Densities``                      | float32 | N          | :math:`10^{10} \mathrm{M}_\odot a^{-3} \mathrm{Mpc}^{-3}`                  | Co-moving mass densities of the particles                                                                                                                                                                                |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``ElectronNumberDensities``        | float64 | N          | :math:`\mathrm{Mpc}^{-3}`                                                  | Electron number densities in the physical frame computed based on the cooling tables. This is 0 for star-forming particles.                                                                                              |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``FOFGroupIDs``                    | int64   | N          | :math:`-`                                                                  | Friends-Of-Friends ID of the group the particles belong to                                                                                                                                                               |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``LastAGNFeedbackScaleFactors``    | float32 | N          | :math:`-`                                                                  | Scale-factors at which the particles were last directly hit by AGN feedback. -1 if a particle has never been directly hit by feedback                                                                                    |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``Masses``                         | float32 | N          | :math:`10^{10} \mathrm{M}_\odot`                                           | Masses of the particles                                                                                                                                                                                                  |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``MaximalTemperatureScaleFactors`` | float32 | N          | :math:`-`                                                                  | Scale-factors at which the maximal temperature was reached                                                                                                                                                               |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``MaximalTemperatures``            | float64 | N          | :math:`\mathrm{K}`                                                         | Maximal temperatures ever reached by the particles                                                                                                                                                                       |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``MetalMassFractions``             | float32 | N          | :math:`-`                                                                  | Fractions of the particles' masses that are in metals                                                                                                                                                                    |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``ParticleIDs``                    | uint64  | N          | :math:`-`                                                                  | Unique IDs of the particles                                                                                                                                                                                              |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``Pressures``                      | float32 | N          | :math:`a^{-5} 10^{10}\mathrm{M}_\odot \mathrm{Mpc^{-3}} \mathrm{(km/s)}^2` | Co-moving pressures of the particles                                                                                                                                                                                     |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``SmoothedElementMassFractions``   | float32 | N,9        | :math:`-`                                                                  | The ratio of the SPH-smoothed mass density in the given element and the SPH-smoothed total gas mass density (see :ref:`element-names`)                                                                                   |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``SmoothedMetalMassFractions``     | float32 | N          | :math:`-`                                                                  | The ratio of the SPH-smoothed mass density in metals and the SPH-smoothed total gas mass density                                                                                                                         |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``SmoothingLengths``               | float32 | N          | :math:`a\mathrm{Mpc}`                                                      | Co-moving smoothing lengths (FWHM of the kernel) of the particles                                                                                                                                                        |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``StarFormationRates``             | float32 | N          | :math:`10^{10} \mathrm{M}_\odot \mathrm{Mpc}^{-1} \mathrm{km/s}`           | If positive, star formation rate of the particle. If negative, stores the last time/scale-factor at which the gas particle was star-forming. If zero, the particle was never star-forming.                               |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``Temperatures``                   | float32 | N          | :math:`\mathrm{K}`                                                         | Temperatures of the gas particles                                                                                                                                                                                        |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``Velocities``                     | float32 | N,3        | :math:`\mathrm{km}/\mathrm{s}`                                             | Peculiar velocities of the gas particles. This is :math:`a*dx/dt` where :math:`x` is the co-moving position of the particle                                                                                              |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``VelocityDivergences``            | float32 | N          | :math:`\mathrm{Mpc^{-1}} \mathrm{km/s}`                                    | Local velocity divergence field around the particles. Provided without cosmology, as this includes the Hubble flow. To return to a peculiar velocity divergence, :math:`\nabla . v_{pec} = a^2 (\nabla . v - 3 H)`       |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``XrayLuminosities``               | float64 | N,3        | :math:`\mathrm{Mpc}^{-1} \mathrm{M}_{\odot} \mathrm{(km/s)}^3`             | Intrinsic X-ray luminosities (i.e. energy per unit time) in various bands in the :math:`z=0` observer frame. This is 0 for star-forming particles (see :ref:`xray-bands`) **TODO: xray table bug?**                      |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``XrayPhotonLuminosities``         | float64 | N,3        | :math:`\mathrm{Mpc^{-1}} \mathrm{km/s}`                                    | Intrinsic X-ray photon luminosities (i.e. number of photons per unit time) in various bands in the :math:`z=0` observer frame. This is 0 for star-forming particles (see :ref:`xray-bands`) **TODO: xray table bug?**    |
+------------------------------------+---------+------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Dark matter particles
---------------------

Dark matter particles are stored in the HDF5 group ``/PartType1``,
which is also soft-linked as ``/DMParticles``. This group contains
HDF5 datasets which store the following particle properties:

+-----------------+---------+------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
| Name            | Type    | Shape      | Units                               | Description                                                                                                                 |
+=================+=========+============+=====================================+=============================================================================================================================+
| ``Coordinates`` | float64 | N,3        | :math:`a\mathrm{Mpc}`               | Co-moving positions of the particles                                                                                        |
+-----------------+---------+------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
| ``FOFGroupIDs`` | int64   | N          | :math:`-`                           | Friends-Of-Friends ID of the group the particles belong to                                                                  |
+-----------------+---------+------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
| ``Masses``      | float32 | N          | :math:`10^{10} \mathrm{M}_\odot`    | Masses of the particles                                                                                                     |
+-----------------+---------+------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
| ``ParticleIDs`` | uint64  | N          | :math:`-`                           | Unique ID of the particles                                                                                                  |
+-----------------+---------+------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
| ``Softenings``  | float32 | N          | :math:`a\mathrm{Mpc}`               | Co-moving Plummer-equivalent softening lengths of the particles.                                                            |
+-----------------+---------+------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
| ``Velocities``  | float32 | N,3        | :math:`\mathrm{km/s}`               | Peculiar velocities of the particles. This is :math:`a * dx/dt` where :math:`x` is the co-moving position of the particle.  |
+-----------------+---------+------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------+

Star particles
--------------

Star particles are stored in the HDF5 group ``/PartType4``,
which is also soft-linked as ``/StarsParticles``. This group contains
HDF5 datasets which store the following particle properties:

+----------------------------------+---------+------------+---------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                             | Type    | Shape      | Units                                                                     | Description                                                                                                                                                                                         |
+==================================+=========+============+===========================================================================+=====================================================================================================================================================================================================+
| ``BirthDensities``               | float32 | N          | :math:`10^{10} \mathrm{M}_\odot \mathrm{Mpc}^{-3}`                        | Physical gas densities at the time the gas particles turned into stars (note that we store the physical density at the birth redshift, no conversion is needed)                                     |
+----------------------------------+---------+------------+---------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``BirthScaleFactors``            | float32 | N          | :math:`-`                                                                 | Scale-factors at which the stars were born                                                                                                                                                          |
+----------------------------------+---------+------------+---------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``Coordinates``                  | float64 | N,3        | :math:`a\mathrm{Mpc}`                                                     | Co-moving positions of the particles                                                                                                                                                                |
+----------------------------------+---------+------------+---------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``FOFGroupIDs``                  | int64   | N          | :math:`-`                                                                 | Friends-Of-Friends ID of the group the particles belong to                                                                                                                                          |
+----------------------------------+---------+------------+---------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``InitialMasses``                | float32 | N          | :math:`10^{10} \mathrm{M}_\odot`                                          | Masses of the star particles at birth time                                                                                                                                                          |
+----------------------------------+---------+------------+---------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``Luminosities``                 | float32 | N,9        | :math:`\mathrm{maggies}`                                                  | Rest-frame, dust-free AB flux at 10pc distance in each of the GAMA bands (see :ref:`luminosities` for details)                                                                                      |
+----------------------------------+---------+------------+---------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``Masses``                       | float32 | N          | :math:`10^{10} \mathrm{M}_\odot`                                          | Masses of the particles at the current point in time (i.e. after stellar losses)                                                                                                                    |
+----------------------------------+---------+------------+---------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``MetalMassFractions``           | float32 | N          | :math:`-`                                                                 | Fractions of the particles' masses that are in metals                                                                                                                                               |
+----------------------------------+---------+------------+---------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``ParticleIDs``                  | uint64  | N          | :math:`-`                                                                 | Unique ID of the particles                                                                                                                                                                          |
+----------------------------------+---------+------------+---------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``SmoothedElementMassFractions`` | float32 | N,9        | :math:`-`                                                                 | Ratio of the SPH-smoothed mass density in the given element and the SPH-smoothed total gas mass density. Inherited from the gas particle which formed this star particle (see :ref:`element-names`) |
+----------------------------------+---------+------------+---------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``SmoothedMetalMassFractions``   | float32 | N          | :math:`-`                                                                 | Ratio of the SPH-smoothed mass density in metals and the SPH-smoothed total gas mass density. Inherited from the gas particle which formed this star particle (see :ref:`element-names`)            |
+----------------------------------+---------+------------+---------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``SmoothingLengths``             | float32 | N          | :math:`a\mathrm{Mpc}`                                                     | Co-moving smoothing lengths (FWHM of the kernel) of the particles                                                                                                                                   |
+----------------------------------+---------+------------+---------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``Velocities``                   | float32 | N,3        | :math:`\mathrm{km/s}`                                                     | Peculiar velocities of the particles. This is :math:`a * dx/dt` where :math:`x` is the co-moving position of the particle.                                                                          |
+----------------------------------+---------+------------+---------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Black hole particles
--------------------

Black hole particles are stored in the HDF5 group ``/PartType5``,
which is also soft-linked as ``/BHParticles``. This group contains
HDF5 datasets which store the following particle properties:

+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                      | Type    | Shape      | Units                                                               | Description                                                                                                                                           |
+===========================================+=========+============+=====================================================================+=======================================================================================================================================================+
| ``AccretionRates``                        | float32 | N          | :math:`10^{10} \mathrm{M}_\odot \mathrm{Mpc}^{-1} \mathrm{km/s}`    | Physical instantaneous accretion rates of the particles                                                                                               |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``Coordinates``                           | float64 | N,3        | :math:`a\mathrm{Mpc}`                                               | Co-moving positions of the particles                                                                                                                  |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``DynamicalMasses``                       | float32 | N          | :math:`10^{10} \mathrm{M}_\odot`                                    | Dynamical masses of the particles                                                                                                                     |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``FOFGroupIDs``                           | int64   | N          | :math:`-`                                                           | Friends-Of-Friends ID of the group the particles belong to                                                                                            |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``FormationScaleFactors``                 | float32 | N          | :math:`-`                                                           | Scale-factors at which the BHs were formed                                                                                                            |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``LastAGNFeedbackScaleFactors``           | float32 | N          | :math:`-`                                                           | Scale-factors at which the black holes last had an AGN event.                                                                                         |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``LastHighEddingtonFractionScaleFactors`` | float32 | N          | :math:`-`                                                           | Scale-factors at which the black holes last reached an Eddington ratio greater than 0.1. -1 if never reached.                                         |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``LastMajorMergerScaleFactors``           | float32 | N          | :math:`-`                                                           | Scale-factors at which the black holes last had a major merger, defined as a merger with a ratio of subgrid masses :math:`r > 0.333`.                 |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``LastMinorMergerScaleFactors``           | float32 | N          | :math:`-`                                                           | Scale-factors at which the black holes last had a minor merger, defined as a merger with a ratio of subgrid masses :math:`0.1 < r <= 0.333`.          |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``NumberOfAGNEvents``                     | int32   | N          | :math:`-`                                                           | Number of AGN events the black hole has had so far (the number of times the BH did AGN feedback)                                                      |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``NumberOfHeatingEvents``                 | int32   | N          | :math:`-`                                                           | Number of (thermal) energy injections the black hole has had so far                                                                                   |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``NumberOfMergers``                       | int32   | N          | :math:`-`                                                           | Number of mergers the black holes went through. This does not include the number of mergers accumulated by any merged black hole.                     |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``ParticleIDs``                           | uint64  | N          | :math:`-`                                                           | Unique ID of the particles                                                                                                                            |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``SmoothingLengths``                      | float32 | N          | :math:`a\mathrm{Mpc}`                                               | Co-moving smoothing lengths (FWHM of the kernel) of the particles                                                                                     |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``SubgridMasses``                         | float32 | N          | :math:`10^{10} \mathrm{M}_\odot`                                    | Subgrid masses of the particles                                                                                                                       |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``TotalAccretedMasses``                   | float32 | N          | :math:`10^{10} \mathrm{M}_\odot`                                    | Total mass accreted onto the particles since its birth                                                                                                |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``Velocities``                            | float32 | N,3        | :math:`\mathrm{km/s}`                                               | Peculiar velocities of the particles. This is :math:`a * dx/dt` where :math:`x` is the co-moving position of the particle.                            |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+

There are two simulations which use the Jet AGN implementation: ``Jet`` and ``Jet_fgas-4sigma``. These runs have some additional black hole particle properties:

+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                      | Type    | Shape      | Units                                                               | Description                                                                                                                                           |
+===========================================+=========+============+=====================================================================+=======================================================================================================================================================+
| ``AccretionDiscAspectRatios``             | float32 | N          | :math:`-`                                                           | The aspect ratio, :math:`h/r`, of the subgrid accretion disk around the black hole (note the inconsistent spelling of disc vs disk!).                 |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``AccretionModes``                        | int32   | N          | :math:`-`                                                           | Accretion flow regime  (0 = thick disk, 1 = thin disk, 2 = slim disk)                                                                                 |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``AngularMomentumDirections``             | float32 | N,3        | :math:`-`                                                           | Direction of the black hole spin vector, normalised to unity.                                                                                         |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``CosAccretionDiskAngle``                 | float32 | N          | :math:`-`                                                           | Cosine of the angle between the spin vector and the accreting gas angular momentum.                                                                   |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``FOFGroupMasses``                        | float32 | N          | :math:`10^{10} \mathrm{M}_\odot`                                    | Parent halo masses of the black holes, as determined using the FOF algorithm.                                                                         |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``GasCurlVelocities``                     | float32 | N,3        | :math:`\mathrm{km/s}`                                               | Velocity curl (3D) of the gas particles around the black holes.                                                                                       |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``GasVelocityDispersions``                | float32 | N          | :math:`\mathrm{km/s}`                                               | Velocity dispersion (3D) of the gas particles around the black holes.                                                                                 |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``InjectedJetEnergies``                   | float32 | N          | :math:`10^{10} \mathrm{M}_\odot (\mathrm{km/s})^2`                  | Total jet energy injected into AGN surroundings.                                                                                                      |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``JetReservoir``                          | float32 | N          | :math:`10^{10} \mathrm{M}_\odot (\mathrm{km/s})^2`                  | Total jet energy waiting to be released (once it grows large enough to kick a single particle)                                                        |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``JetTimeSteps``                          | float32 | N          | :math:`\mathrm{Mpc} \mathrm{(km/s)}^{-1}`                           | Jet-launching-limited time-steps of black holes.                                                                                                      |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``LastAGNJetScaleFactors``                | float32 | N          | :math:`-`                                                           | Scale-factors at which the black holes last had an AGN jet event.                                                                                     |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``NumberOfAGNJetEvents``                  | int32   | N          | :math:`-`                                                           | Number of AGN jet launching events the black hole has had (i.e. the number of times the BH did AGN jet feedback)                                      |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``NumberOfJetParticlesLaunched``          | int32   | N          | :math:`-`                                                           | Number of (kinetic) energy injections the black hole has had so far                                                                                   |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``RadiativeEfficiencies``                 | float32 | N          | :math:`-`                                                           | AGN luminosity divided by accretion rate.                                                                                                             |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``Spins``                                 | float32 | N          | :math:`-`                                                           | Dimensionless spins of the black holes. Negative values indicate retrograde accretion.                                                                |
+-------------------------------------------+---------+------------+---------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+

Neutrino particles
------------------

Neutrino particles are stored in the HDF5 group ``/PartType6``, which
is also soft-linked as ``/NeutrinoParticles``. This group contains
HDF5 datasets which store the following particle properties:

+-------------------+---------+------------+-------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name              | Type    | Shape      | Units                               | Description                                                                                                                                              |
+===================+=========+============+=====================================+==========================================================================================================================================================+
| ``Coordinates``   | float64 | N,3        | :math:`a\mathrm{Mpc}`               | Co-moving positions of the particles                                                                                                                     |
+-------------------+---------+------------+-------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``Masses``        | float32 | N          | :math:`10^{10} \mathrm{M}_\odot`    | Masses of the neutrino particles                                                                                                                         |
+-------------------+---------+------------+-------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``ParticleIDs``   | uint64  | N          | :math:`-`                           | Unique ID of the particles                                                                                                                               |
+-------------------+---------+------------+-------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``SampledSpeeds`` | float32 | N          | :math:`\mathrm{km/s}`               | Initial Fermi-Dirac speed sampled at infinity. This is :math:`a * |dx/dt|` where :math:`x` is the co-moving position of the particles.                   |
+-------------------+---------+------------+-------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``Softenings``    | float32 | N          | :math:`a\mathrm{Mpc}`               | Co-moving Plummer-equivalent softening lengths of the particles.                                                                                         |
+-------------------+---------+------------+-------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``Velocities``    | float32 | N,3        | :math:`\mathrm{km/s}`               | Peculiar velocities of the particles. This is :math:`a * dx/dt` where :math:`x` is the co-moving position of the particle.                               |
+-------------------+---------+------------+-------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| ``Weights``       | float64 | N          | :math:`-`                           | Statistical weights of the neutrino particles. See `Elbers et al (2021) <https://ui.adsabs.harvard.edu/abs/2021MNRAS.507.2614E/abstract>`__ for details. |
+-------------------+---------+------------+-------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+

Named columns
-------------

Certain two dimensional datasets in the snapshots store arrays of
related quantities, such as luminosities in different bands or
abundances of different elements. In these cases the dataset has
dimensions ``[N,M]`` where ``N`` is the number of particles in the
dataset and ``M`` is the number of quantities stored per particle.

The tables below document the meaning of the "column" index ``M`` for
these datasets.

.. _element-names:

Element fractions
^^^^^^^^^^^^^^^^^

Gas and star particles have a ``SmoothedElementMassFractions`` dataset
which contains smoothed mass fractions for 9 different elements. The
smoothed mass fraction is defined as the ratio of the SPH-smoothed
mass density of the element and the SPH-smoothed total gas mass
density.

In the case of star particles, the element and metal mass fractions
are evaluated in the gas at the time the star particle formed. The
star particle then retains this value at all later times.

+-------------+---------------------+
| Array index | Element name        |
+=============+=====================+
| 0           | Hydrogen            |
+-------------+---------------------+
| 1           | Helium              |
+-------------+---------------------+
| 2           | Carbon              |
+-------------+---------------------+
| 3           | Nitrogen            |
+-------------+---------------------+
| 4           | Oxygen              |
+-------------+---------------------+
| 5           | Neon                |
+-------------+---------------------+
| 6           | Magnesium           |
+-------------+---------------------+
| 7           | Silicon             |
+-------------+---------------------+
| 8           | Iron                |
+-------------+---------------------+


.. _xray-bands:

X-ray bands
^^^^^^^^^^^

Gas particles have ``XrayLuminosities`` (energy per unit time) and
``XrayPhotonLuminosities`` (number of photons per unit time) datasets
which contain data for three different observer frame X-ray bands:

+-------------+---------------------+
| Array index | Band                |
+=============+=====================+
| 0           | eROSITA 0.2-2.3keV  |
+-------------+---------------------+
| 1           | eROSITA 2.3-8.0keV  |
+-------------+---------------------+
| 2           | ROSAT 0.5-2.0keV    |
+-------------+---------------------+

.. _luminosities:

Stellar luminosities
^^^^^^^^^^^^^^^^^^^^

.. warning:: Star particle "luminosities" are stored in terms of flux
             and do NOT use the same units as the X-ray luminosity
             datasets described above.

Star particles have a ``Luminosities`` dataset. For each particle and
photometric band this contains the rest frame flux at 10pc, expressed
in maggies. Maggies are a dimensionless measure of flux defined as the
ratio :math:`F/F_0`, where :math:`F_0=3631\mathrm{Jy}` is the flux
corresponding to an AB magnitude of zero. Dust extinction is not
included. These were computed using the `BC03
<https://ui.adsabs.harvard.edu/abs/2003MNRAS.344.1000B/abstract>`_
(GALAXEV) models convolved with the different filter bands, as used in
the dust-free modelling of `Trayford et al. (2015)
<https://ui.adsabs.harvard.edu/abs/2015MNRAS.452.2879T/abstract>`_.

The rest frame, absolute AB-magnitude can be computed as:

  :math:`M = -2.5 \log10(L)`

where ``L`` is the dimensionless number stored in the
dataset. Luminosities for the `GAMA <https://www.gama-survey.org/>`__
bands are stored in the following order:

+-------------+---------------------+
| Array index | Band                |
+=============+=====================+
| 0           | u                   |
+-------------+---------------------+
| 1           | g                   |
+-------------+---------------------+
| 2           | r                   |
+-------------+---------------------+
| 3           | i                   |
+-------------+---------------------+
| 4           | z                   |
+-------------+---------------------+
| 5           | Y                   |
+-------------+---------------------+
| 6           | J                   |
+-------------+---------------------+
| 7           | H                   |
+-------------+---------------------+
| 8           | K                   |
+-------------+---------------------+
