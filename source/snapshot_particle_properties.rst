Particle properties
===================

This page documents all of the properties which are stored for each
type of particle in a FLAMINGO snapshot.

Gas particles
-------------

Gas particles are stored in the HDF5 group ``/PartType0``, which is
also soft-linked as ``/GasParticles``. This group contains HDF5
datasets which store the following particle properties:

.. container:: landscape

    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | Name                           | Type    | Shape      | Units                               | Description                                                                                                                                                                                                              |
    +================================+=========+============+=====================================+==========================================================================================================================================================================================================================+
    | ComptonYParameters             | float32 | N          |                                     | Compton y parameters in the physical frame computed based on the cooling tables. This is 0 for star-forming particles.                                                                                                   |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | Coordinates                    | float64 | N,3        |                                     | Co-moving positions of the particles                                                                                                                                                                                     |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | Densities                      | float32 | N          |                                     | Co-moving mass densities of the particles                                                                                                                                                                                |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | ElectronNumberDensities        | float64 | N          |                                     | Electron number densities in the physical frame computed based on the cooling tables. This is 0 for star-forming particles.                                                                                              |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | FOFGroupIDs                    | int64   | N          |                                     | Friends-Of-Friends ID of the group the particles belong to                                                                                                                                                               |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | LastAGNFeedbackScaleFactors    | float32 | N          |                                     | Scale-factors at which the particles were last hit by AGN feedback. -1 if a particle has never been hit by feedback                                                                                                      |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | Masses                         | float32 | N          |                                     | Masses of the particles                                                                                                                                                                                                  |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | MaximalTemperatureScaleFactors | float32 | N          |                                     | Scale-factors at which the maximal temperature was reached                                                                                                                                                               |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | MaximalTemperatures            | float64 | N          |                                     | Maximal temperatures ever reached by the particles                                                                                                                                                                       |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | MetalMassFractions             | float32 | N          |                                     | Fractions of the particles' masses that are in metals                                                                                                                                                                    |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | ParticleIDs                    | uint64  | N          |                                     | Unique IDs of the particles                                                                                                                                                                                              |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | Pressures                      | float32 | N          |                                     | Co-moving pressures of the particles                                                                                                                                                                                     |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | SmoothedElementMassFractions   | float32 | N,9        |                                     | Smoothed fractions of the particles' masses that are in the given element (see :ref:`element-names`)                                                                                                                     |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | SmoothedMetalMassFractions     | float32 | N          |                                     | Smoothed fractions of the particles masses that are in metals                                                                                                                                                            |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | SmoothingLengths               | float32 | N          |                                     | Co-moving smoothing lengths (FWHM of the kernel) of the particles                                                                                                                                                        |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | StarFormationRates             | float32 | N          |                                     | If positive, star formation rates of the particles. If negative, stores the last time/scale-factor at which the gas particle was star-forming. If zero, the particle was never star-forming.                             |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | Temperatures                   | float32 | N          |                                     | Temperatures of the gas particles                                                                                                                                                                                        |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | Velocities                     | float32 | N,3        |                                     | Peculiar velocities of the gas particles. This is :math:`a*dx/dt` where :math:`x` is the co-moving positions of the particles                                                                                            |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | VelocityDivergences            | float32 | N          |                                     | Local velocity divergence field around the particles. Provided without cosmology, as this includes the Hubble flow. To return to a peculiar velocity divergence, :math:`\nabla . v_{pec} = a^2 (\nabla . v - n_D H)`     |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | XrayLuminosities               | float64 | N,3        |                                     | Intrinsic X-ray luminosities in various bands. This is 0 for star-forming particles (see :ref:`xray-bands`)                                                                                                              |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
    | XrayPhotonLuminosities         | float64 | N,3        |                                     | Intrinsic X-ray photon luminosities in various bands. This is 0 for star-forming particles (see :ref:`xray-bands`)                                                                                                       |
    +--------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Dark matter particles
---------------------

Dark matter particles are stored in the HDF5 group ``/PartType1``,
which is also soft-linked as ``/DMParticles``. This group contains
HDF5 datasets which store the following particle properties:

+-------------+---------+------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
| Name        | Type    | Shape      | Units                               | Description                                                                                                                 |
+=============+=========+============+=====================================+=============================================================================================================================+
| Coordinates | float64 | N,3        | cMpc                                | Co-moving position of the particles                                                                                         |
+-------------+---------+------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
| FOFGroupIDs | int64   | N          |                                     | Friends-Of-Friends ID of the group the particles belong to                                                                  |
+-------------+---------+------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
| Masses      | float32 | N          | :math:`10^{10} M_\odot`             | Masses of the particles                                                                                                     |
+-------------+---------+------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
| ParticleIDs | uint64  | N          |                                     | Unique ID of the particles                                                                                                  |
+-------------+---------+------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
| Softenings  | float32 | N          | cMpc                                | Co-moving Plummer-equivalent softening lengths of the particles.                                                            |
+-------------+---------+------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------+
| Velocities  | float32 | N,3        | km/s                                | Peculiar velocities of the particles. This is :math:`a * dx/dt` where :math:`x` is the co-moving position of the particles. |
+-------------+---------+------------+-------------------------------------+-----------------------------------------------------------------------------------------------------------------------------+

Star particles
--------------

Star particles are stored in the HDF5 group ``/PartType4``,
which is also soft-linked as ``/StarsParticles``. This group contains
HDF5 datasets which store the following particle properties:

+------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                         | Type    | Shape      | Units                               | Description                                                                                                                                                                                      |
+==============================+=========+============+=====================================+==================================================================================================================================================================================================+
| BirthDensities               | float32 | N          |                                     | Physical densities at the time of birth of the gas particles that turned into stars (note that we store the physical density at the birth redshift, no conversion is needed)                     |
+------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| BirthScaleFactors            | float32 | N          |                                     | Scale-factors at which the stars were born                                                                                                                                                       |
+------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Coordinates                  | float64 | N,3        |                                     | Co-moving position of the particles                                                                                                                                                              |
+------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| FOFGroupIDs                  | int64   | N          |                                     | Friends-Of-Friends ID of the group the particles belong to                                                                                                                                       |
+------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| InitialMasses                | float32 | N          |                                     | Masses of the star particles at birth time                                                                                                                                                       |
+------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Luminosities                 | float32 | N,9        |                                     | Rest-frame dust-free AB-luminosities of the star particles in the GAMA bands (see :ref:`luminosities` for details)                                                                               |
+------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Masses                       | float32 | N          |                                     | Masses of the particles at the current point in time (i.e. after stellar losses                                                                                                                  |
+------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| MetalMassFractions           | float32 | N          |                                     | Fractions of the particles' masses that are in metals                                                                                                                                            |
+------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ParticleIDs                  | uint64  | N          |                                     | Unique ID of the particles                                                                                                                                                                       |
+------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| SmoothedElementMassFractions | float32 | N,9        |                                     | Smoothed fractions of the particles' masses that are in the given element (see :ref:`element-names`)                                                                                             |
+------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| SmoothedMetalMassFractions   | float32 | N          |                                     | Smoothed fractions of the particles masses that are in metals                                                                                                                                    |
+------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| SmoothingLengths             | float32 | N          |                                     | Co-moving smoothing lengths (FWHM of the kernel) of the particles                                                                                                                                |
+------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Velocities                   | float32 | N,3        |                                     | Peculiar velocities of the particles. This is :math:`a * dx/dt` where :math:`x` is the co-moving position of the particles.                                                                      |
+------------------------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Black hole particles
--------------------

Black hole particles are stored in the HDF5 group ``/PartType5``,
which is also soft-linked as ``/BHParticles``. This group contains
HDF5 datasets which store the following particle properties:

+---------------------------------------+---------+------------+-------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| Name                                  | Type    | Shape      | Units                               | Description                                                                                                                                           |
+=======================================+=========+============+=====================================+=======================================================================================================================================================+
| AccretionRates                        | float32 | N          |                                     | Physical instantaneous accretion rates of the particles                                                                                               |
+---------------------------------------+---------+------------+-------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| Coordinates                           | float64 | N,3        |                                     | Co-moving position of the particles                                                                                                                   |
+---------------------------------------+---------+------------+-------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| DynamicalMasses                       | float32 | N          |                                     | Dynamical masses of the particles                                                                                                                     |
+---------------------------------------+---------+------------+-------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| FOFGroupIDs                           | int64   | N          |                                     | Friends-Of-Friends ID of the group the particles belong to                                                                                            |
+---------------------------------------+---------+------------+-------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| FormationScaleFactors                 | float32 | N          |                                     | Scale-factors at which the BHs were formed                                                                                                            |
+---------------------------------------+---------+------------+-------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| LastAGNFeedbackScaleFactors           | float32 | N          |                                     | Scale-factors at which the black holes last had an AGN event.                                                                                         |
+---------------------------------------+---------+------------+-------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| LastHighEddingtonFractionScaleFactors | float32 | N          |                                     | Scale-factors at which the black holes last reached a large Eddington ratio. -1 if never reached.                                                     |
+---------------------------------------+---------+------------+-------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| LastMajorMergerScaleFactors           | float32 | N          |                                     | Scale-factors at which the black holes last had a major merger.                                                                                       |
+---------------------------------------+---------+------------+-------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| LastMinorMergerScaleFactors           | float32 | N          |                                     | Scale-factors at which the black holes last had a minor merger.                                                                                       |
+---------------------------------------+---------+------------+-------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| NumberOfAGNEvents                     | int32   | N          |                                     | Integer number of AGN events the black hole has had so far (the number of times the BH did AGN feedback)                                              |
+---------------------------------------+---------+------------+-------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| NumberOfHeatingEvents                 | int32   | N          |                                     | Integer number of (thermal) energy injections the black hole has had so far                                                                           |
+---------------------------------------+---------+------------+-------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| NumberOfMergers                       | int32   | N          |                                     | Number of mergers the black holes went through. This does not include the number of mergers accumulated by any merged black hole.                     |
+---------------------------------------+---------+------------+-------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| ParticleIDs                           | uint64  | N          |                                     | Unique ID of the particles                                                                                                                            |
+---------------------------------------+---------+------------+-------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| SmoothingLengths                      | float32 | N          |                                     | Co-moving smoothing lengths (FWHM of the kernel) of the particles                                                                                     |
+---------------------------------------+---------+------------+-------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| SubgridMasses                         | float32 | N          |                                     | Subgrid masses of the particles                                                                                                                       |
+---------------------------------------+---------+------------+-------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| TotalAccretedMasses                   | float32 | N          |                                     | Total mass accreted onto the particles since its birth                                                                                                |
+---------------------------------------+---------+------------+-------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+
| Velocities                            | float32 | N,3        |                                     | Peculiar velocities of the particles. This is :math:`a * dx/dt` where :math:`x` is the co-moving position of the particles.                           |
+---------------------------------------+---------+------------+-------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------+


Neutrino particles
------------------

Neutrino particles are stored in the HDF5 group ``/PartType6``, which
is also soft-linked as ``/NeutrinoParticles``. This group contains
HDF5 datasets which store the following particle properties:

+---------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Name          | Type    | Shape      | Units                               | Description                                                                                                                                |
+===============+=========+============+=====================================+============================================================================================================================================+
| Coordinates   | float64 | N,3        |                                     | Co-moving position of the particles                                                                                                        |
+---------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Masses        | float32 | N          |                                     | Masses of the particles                                                                                                                    |
+---------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| ParticleIDs   | uint64  | N          |                                     | Unique ID of the particles                                                                                                                 |
+---------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| SampledSpeeds | float32 | N          |                                     | Initial Fermi-Dirac speed sampled at infinity. This is :math:`a * |dx/dt|` where :math:`x` is the co-moving position of the particles.     |
+---------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Softenings    | float32 | N          |                                     | Co-moving Plummer-equivalent softening lengths of the particles.                                                                           |
+---------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Velocities    | float32 | N,3        |                                     | Peculiar velocities of the particles. This is :math:`a * dx/dt` where :math:`x` is the co-moving position of the particles.                |
+---------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Weights       | float64 | N          |                                     | Statistical weights of neutrino particles                                                                                                  |
+---------------+---------+------------+-------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------+

Named columns
-------------

Certain two dimensional datasets in the snapshots store arrays of
related quantities, such as luminosities in different bands or
abundances of different elements. In these cases the dataset has
dimensions ``[N,M]`` where ``N`` is the number of particles in the
dataset and ``M`` is the number of quantities stored per particle.

The tables below document the meaning of the "column" index ``M`` for
these datasets.

.. _element-names:

Element names
^^^^^^^^^^^^^

Gas and star particles have a ``SmoothedElementMassFractions`` dataset
which contains smoothed mass fractions for 9 different elements.

+-------------+---------------------+
| Array index | Element name        |
+=============+=====================+
| 0           | Hydrogen            |
+-------------+---------------------+
| 1           | Helium              |
+-------------+---------------------+
| 2           | Carbon              |
+-------------+---------------------+
| 3           | Nitrogen            |
+-------------+---------------------+
| 4           | Oxygen              |
+-------------+---------------------+
| 5           | Neon                |
+-------------+---------------------+
| 6           | Magnesium           |
+-------------+---------------------+
| 7           | Silicon             |
+-------------+---------------------+
| 8           | Iron                |
+-------------+---------------------+


.. _xray-bands:

X-ray bands
^^^^^^^^^^^

Gas particles have ``XrayLuminosities`` and ``XrayPhotonLuminosities``
datasets which contain data for three different X-ray bands:

+-------------+---------------------+
| Array index | Band                |
+=============+=====================+
| 0           | eROSITA 0.2-2.3keV  |
+-------------+---------------------+
| 1           | eROSITA 2.3-8.0keV  |
+-------------+---------------------+
| 2           | ROSAT 0.5-2.0keV    |
+-------------+---------------------+

.. _luminosities:

Stellar luminosities
^^^^^^^^^^^^^^^^^^^^

Star particles have a ``Luminosities`` dataset. This contains
rest-frame dust-free AB-luminosities of the star particles in the GAMA
bands. These were computed using the BC03 (GALAXEV) models convolved
with different filter bands and interpolated in log-log
:math:`(f(\log(Z), \log(age)) = \log(flux))` as used in the dust-free
modelling of Trayford et al. (2015). The luminosities are given in
dimensionless units. They have been divided by 3631 Jy already,
i.e. they can be turned into absolute AB-magnitudes (rest-frame
absolute maggies) directly by applying :math:`-2.5 \log10(L)` without
additional corrections.

Luminosities in the GAMA bands are stored in the following order:

+-------------+---------------------+
| Array index | Band                |
+=============+=====================+
| 0           | u                   |
+-------------+---------------------+
| 1           | g                   |
+-------------+---------------------+
| 2           | r                   |
+-------------+---------------------+
| 3           | i                   |
+-------------+---------------------+
| 4           | z                   |
+-------------+---------------------+
| 5           | Y                   |
+-------------+---------------------+
| 6           | H                   |
+-------------+---------------------+
| 7           | J                   |
+-------------+---------------------+
| 8           | K                   |
+-------------+---------------------+
